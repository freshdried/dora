<html>
<head>
<title>dora shell</title>
<style type="text/css">
body {
	font-family: monospace;
	background: #252726;
	color: white;
	font-family: monospace;
}
p {
	font-weight: bold;
}
#buttons div {
	position: fixed;
	width: 23%;
	height: 40%;
	top: 40%;
}

#a {
	left: 5%;
}
#b {
	left: 38%;
}
#c {
	left: 71%;
}
#text{
	position: fixed;
	left: 5%;
	top: 5%;
	white-space: pre;
}
b {
	font-size: xx-large;
}
a {
	color: #959796;
	text-decoration: none;
}
</style>
</head>
<body>
<script src="/core-client/core-client.js"></script>
<script src="./jquery-2.0.3.min.js"></script>
<div id="buttons">
	<div id="a"></div>
	<div id="b"></div>
	<div id="c"></div>
</div>
<div id="text">
<b>DORA</b>: Dorm Room Automation

by Sean Lee


[ <a href="/dance.html">dance</a> ]    [ <a href="/snake.html">snake</a> ]
</div>

<script>
var Core = require('core-client');
var core = new Core();

core.on('ready', function() {
	['a', 'b', 'c'].map(function(relayid) {
		var device = core.motor.devices[relayid];

		var updateState = function(cb) {
			device.commands.getstate(function(data) {
				cb(data);
			});
		}
		var changeModel = function(data){
			var color = data.state == 1 ? '#ffac18' : '#000000';
			$("#" + relayid).css({background: color});
		}

		//initialize colors
		updateState(changeModel);
		//on toggle
		$("#" + relayid).click(function() {
			device.commands.toggle();
			updateState(changeModel);
		});
		setInterval(function() {
			updateState(changeModel);
		}, 100);
	});
});

</script>
</body>
</html>
